<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="UTF-8" /><title>Building Low-Code Web Apps with OEMjs</title><meta content="width=device-width, initial-scale=1" name="viewport" /><meta content="This introductory tutorial presents the Object Event Modeling JavaScript framework OEMjs, which allows low-code web app development based on business object, business event and business activity classes defined with property ranges and other property constraints. OEMjs supports building MVC apps with constraint validation and flexible data storage management quickly, without boilerplate code." name="description" /><link href="index_files/ebook.css" rel="stylesheet" type="text/css" /><meta content="OEMjs" name="og:site_name" /><meta content="Tutorial: Low Code Web App Development with OEMjs" name="og:title" /><meta content="en" name="og:locale" /><meta content="This introductory tutorial presents the Object Event Modeling JavaScript framework OEMjs, which allows low-code web app development based on business object, business event and business activity classes defined with property ranges and other property constraints. OEMjs supports building MVC apps with constraint validation and flexible data storage management quickly, without boilerplate code." name="og:description" /><meta content="https://gwagner57.github.io/OEMjs/tutorials/introductory/" name="og:url" /><meta content="https://sim4edu.com/img/sim4edu.png" name="og:image" /><meta content="summary_large_image" name="twitter:card" /><style>/*<![CDATA[*/
div.role-book-title-div {
  text-align: center;
}
h1.role-book-title {
  margin: 4em 0;
  padding-bottom: 0;
  border-bottom-style: none;
}
span.button {
  outline: 1px solid;
  background: aliceblue;
}
table.expStatistics tbody td {
    text-align: right;
}

div.role-book-title-div h1.role-book-title {
    margin-bottom: 0.33em;
}
div[id$="subtitle"] {
    margin-top: 0.33em;
}


div#share {
    display: block; /*inline-block*/
}
ul.links {
    list-style: none;
    padding: 0;
    margin: 0 0 0 1em;
}
ul.links li {
    display: inline;
    text-align: center;
    cursor: pointer;
    margin-right: 1em;
}
ul.links li:hover {
    text-decoration: underline;
}
.icon-social {
    width: 20px;
    height: 20px;
    background: #eee;
}/*]]>*/</style></head><body><section class="role-book" id="tutorial"><div class="role-book-title-div"><h1 class="role-book-title">Building Low-Code Web Apps with OEMjs</h1><div class="role-content" id="tutorial-content-1"><div id="tutorial-content-1__share"> <ul class="links"><li class="share facebook" title="Share on Facebook"><a href="https://www.facebook.com/sharer.php?u=https://sim4edu.com/oesjs/core0/tutorial.html" target="_blank"><svg aria-hidden="true" class="icon-social" xmlns="http://www.w3.org/2000/svg"> <symbol id="social-facebook" viewBox="0 0 18 18"><path d="M15.7,1.5H2.3c-0.5,0-0.8,0.4-0.8,0.8v13.3c0,0.5,0.4,0.8,0.8,0.8h7.2v-5.8h-2V8.4h2V6.8c0-1.9,1.2-3,2.9-3 c0.8,0,1.5,0.1,1.7,0.1v2l-1.2,0c-0.9,0-1.1,0.4-1.1,1.1v1.4h2.2l-0.3,2.3h-1.9v5.8h3.8c0.5,0,0.8-0.4,0.8-0.8V2.3 C16.5,1.9,16.1,1.5,15.7,1.5z"></path></symbol> <use xlink:href="#social-facebook" xmlns:xlink="http://www.w3.org/1999/xlink"></use> </svg></a></li><li class="share twitter" title="Share on Twitter"><a href="https://twitter.com/intent/tweet?url=https://sim4edu.com/oesjs/core0/tutorial.html&amp;text=Tutorial:%20Discrete%20Event%20Simulation%20with%20OESjs-Core0" target="_blank"><svg aria-hidden="true" class="icon-social" xmlns="http://www.w3.org/2000/svg"> <symbol id="social-twitter" viewBox="0 0 18 18"><path d="M16.5,4.3c-0.6,0.2-1.1,0.4-1.8,0.5c0.6-0.4,1.1-1,1.4-1.7c-0.6,0.4-1.3,0.6-2,0.8c-0.6-0.6-1.4-1-2.2-1 c-1.7,0-3.1,1.4-3.1,3.1c0,0.2,0,0.5,0.1,0.7C6.3,6.5,4.1,5.3,2.5,3.4C2.3,3.9,2.1,4.4,2.1,5c0,1.1,0.5,2,1.4,2.6 c-0.5,0-1-0.2-1.4-0.4c0,0,0,0,0,0c0,1.5,1.1,2.8,2.5,3.1c-0.3,0.1-0.5,0.1-0.8,0.1c-0.2,0-0.4,0-0.6-0.1c0.4,1.2,1.5,2.1,2.9,2.2 c-1.1,0.8-2.4,1.3-3.8,1.3c-0.2,0-0.5,0-0.7,0c1.4,0.9,3,1.4,4.7,1.4c5.7,0,8.8-4.7,8.8-8.9c0-0.1,0-0.3,0-0.4 C15.6,5.5,16.1,4.9,16.5,4.3"></path></symbol> <use xlink:href="#social-twitter" xmlns:xlink="http://www.w3.org/1999/xlink"></use> </svg></a></li><li class="share linkedin" title="Share on LinkedIn"><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://sim4edu.com/oesjs/core0/tutorial.html" target="_blank"><svg aria-hidden="true" class="icon-social" xmlns="http://www.w3.org/2000/svg"> <symbol id="social-linkedin" viewBox="0 0 18 18"><path d="M15.4,1.5H2.6C2,1.5,1.5,2,1.5,2.6v12.8c0,0.6,0.5,1.1,1.1,1.1h12.8c0.6,0,1.1-0.5,1.1-1.1V2.6C16.5,2,16,1.5,15.4,1.5z M3.8,7.1H6v7.2H3.8V7.1z M4.9,6.1c-0.7,0-1.3-0.6-1.3-1.3c0-0.7,0.6-1.3,1.3-1.3c0.7,0,1.3,0.6,1.3,1.3C6.2,5.6,5.6,6.1,4.9,6.1z M14.5,14.3h-2.3v-3.5c0-0.8,0-1.9-1.2-1.9c-1.2,0-1.4,0.9-1.4,1.8v3.5H7.4V7.1h2.2v1h0c0.3-0.6,1-1.2,2.1-1.2 c2.3,0,2.7,1.5,2.7,3.4V14.3z"></path></symbol> <use xlink:href="#social-linkedin" xmlns:xlink="http://www.w3.org/1999/xlink"></use> </svg></a></li><li class="share email" title="Share with Email"><a aria-label="Share with Email" href="mailto:?subject=Tutorial:%20Discrete%20Event%20Simulation%20with%20OESjs-Core0&amp;body=This%20article%20shows%20how%20to%20create%20and%20run%20a%20simulation%20model%20with%20the%20JavaScript-based%20simulation%20framework%20OESjs-Core0%20available%20on%20Sim4edu.com.%20OESjs-Core0%20implements%20the%20Object%20Event%20Simulation%20paradigm%2C%20representing%20a%20general%20Discrete%20Event%20Simulation%20approach%20based%20on%20object-oriented%20modeling%20and%20event%20scheduling.%0A%0Ahttps://sim4edu.com/oesjs/core0/tutorial.html" target="_blank"><svg aria-hidden="true" class="icon-social" xmlns="http://www.w3.org/2000/svg"> <symbol id="social-mail" viewBox="0 0 18 18"><path d="M9,8.2L3,4.5h12L9,8.2z M15,13.5H3V6l6,3.8L15,6V13.5z M15,3H3C2.2,3,1.5,3.7,1.5,4.5l0,9C1.5,14.3,2.2,15,3,15 h12c0.8,0,1.5-0.7,1.5-1.5v-9C16.5,3.7,15.8,3,15,3z"></path></symbol> <use xlink:href="#social-mail" xmlns:xlink="http://www.w3.org/1999/xlink"></use> </svg></a></li></ul> </div><div id="tutorial-content-1__subtitle">How to create low-code web apps with the JavaScript framework <a href="https://gwagner57.github.io/OEMjs/">OEMjs</a> available from the <a href="https://github.com/gwagner57/OEMjs">OEMjs GitHub repo</a></div> <div id="tutorial-content-1__authors">Gerd Wagner <a href="mailto:G.Wagner@b-tu.de">G.Wagner@b-tu.de</a></div><p>Copyright Â© 2023 Gerd Wagner (<a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC</a>)</p><p>You may <a href="https://gwagner57.github.io/OEMjs/apps/minimal/" target="_blank">run the example app from our server</a>.</p><p>Published 2023-07-25</p><h2>Abstract</h2><p>This introductory tutorial presents the <em>Object Event Modeling</em> JavaScript framework OEMjs, which allows building low-code web apps based on business object, business event and business activity classes defined with property ranges and other property constraints. OEMjs allows building apps quickly without boilerplate code for constraint validation, data storage management and user interfaces.</p></div></div><div class="role-frontmatter" id="frontmatter"><section class="role-toc" id="toc"><h1 class="role-toc-title">Table of Contents</h1><ul class="role-booklist-entries"><li class="role-booklist-entry booklist-entry-for-lof"><a class="role-lof-ref" href="#lof">List of Figures</a></li><li class="role-booklist-entry booklist-entry-for-lot"><a class="role-lot-ref" href="#lot">List of Tables</a></li><li class="role-booklist-entry booklist-entry-for-chapter"><a class="role-chapter-ref" href="#chapter-1"><span class="role-label"><span class="role-number">1</span>. </span>A Quick Tour to Your First OEMjs App</a><ul class="role-booklist-entries"><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#First-Steps"><span class="role-label"><span class="role-number">1.1</span>. </span>First Steps</a></li><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#Intro-Constraint-Validation"><span class="role-label"><span class="role-number">1.2</span>. </span>Integrity Constraints and Data Validation</a></li><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#Generated-UI"><span class="role-label"><span class="role-number">1.3</span>. </span>Model-Based User Interface Generation</a></li></ul></li><li class="role-booklist-entry booklist-entry-for-appendix"><a class="role-appendix-ref" href="#appendix-1"><span class="role-label"><span class="role-number">A</span>. </span>Constraint Validation Concepts</a><ul class="role-booklist-entries"><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#Concepts-IntegrityConstraints"><span class="role-label"><span class="role-number">A.1</span>. </span>Integrity Constraints</a></li><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#Concepts-ResponsiveValidation"><span class="role-label"><span class="role-number">A.2</span>. </span>Responsive Validation</a></li><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#Concepts-MVC"><span class="role-label"><span class="role-number">A.3</span>. </span>Constraint Validation in MVC Applications</a></li><li class="role-booklist-entry booklist-entry-for-section1"><a class="role-section1-ref" href="#Concepts-DesignModelConstraints"><span class="role-label"><span class="role-number">A.4</span>. </span>Adding Constraints to a Class Design Model</a></li></ul></li><li class="role-booklist-entry booklist-entry-for-index"><a class="role-index-ref" href="#_index">Index</a></li></ul></section><section class="role-lof" id="lof"><h1 class="role-lof-title">List of Figures</h1><ul class="role-booklist-entries"><li class="role-booklist-entry"><a class="role-figure-ref" href="#Concepts-IntegrityConstraints__fig1-1"><span class="role-label"><span class="role-number">A-1</span>. </span>An example of an object-level constraint</a></li></ul></section><section class="role-lot" id="lot"><h1 class="role-lot-title">List of Tables</h1><ul class="role-booklist-entries"><li class="role-booklist-entry"><a class="role-table-ref" href="#Concepts-DesignModelConstraints__lot__1"><span class="role-label"><span class="role-number">A-1</span>. </span>Sample data for <code>Book</code></a></li></ul></section></div><section class="role-chapter" id="chapter-1"><h1 class="role-chapter-title"><span class="role-label">Chapter <span class="role-number">1</span>. </span>A Quick Tour to Your First OEMjs App</h1><section class="role-section1" id="First-Steps"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">1.1</span>. </span>First Steps</h2><p>For setting up a CRUD data management app with OEMjs, you have to write</p><ol><li>a class module file for each of the business object types of your app;</li><li>an <kbd>app.mjs</kbd> module file for creating an <code>app</code> object that imports the app's business object classes and includes a definition of test data;</li><li>an <kbd>index.html</kbd> file for being able to run your app in a browser.</li></ol><p>For all three types of files, you may use a copy from one of the example apps (available at the OEMjs GitHub repo) as your model or starting point. In this tutorial, we use the &quot;Book Data Management&quot; app from the <kbd>apps/minimal</kbd> folder.</p><blockquote class="role-attention"><p>While you can directly run an OEMjs app from a remote website (e.g., from the OEMjs GitHub website) or from a local web server, you can only run it from your <em>local file system</em> after changing your browser's default configuration. For FireFox, you have to set the configuration property <code>privacy.file_unique_origin</code> to <i>false</i> by entering <code>about:config</code> in the browser's web address bar.</p></blockquote><h3>The class module file <kbd>Book.mjs</kbd></h3><p>The &quot;Book Data Management&quot; app has only one class module, <kbd>Book.mjs</kbd>, which defines the business object class <i>Book</i> (with seven properties) in the following way:</p><table class="role-listing" style="width: 100%; border-collapse: collapse;"><colgroup class="listing-numbers-column" style="width: 2.25em;"></colgroup><tbody style="vertical-align: baseline;"><tr><td class="listing-numbers"><pre style="text-align: right; background-color: transparent; border-style: none; padding: 0; margin: 0;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></td><td class="listing-lines"><pre style="text-align: left; background-color: transparent; border-style: none; padding: 0; margin: 0;">import bUSINESSoBJECT from &quot;../../../src/bUSINESSoBJECT.mjs&quot;;
import {dt} from &quot;../../../src/datatypes.mjs&quot;;

class <b>Book</b> extends bUSINESSoBJECT {
  constructor ({isbn, title, year, edition, purchaseDate, 
      recordCreatedOn=new Date(), isReserved=false}) {
    <b>super</b>( <b>isbn</b>);
    this.title = title;
    this.year = year;
    if (edition) this.edition = edition;
    this.purchaseDate = purchaseDate;
    this.recordCreatedOn = recordCreatedOn;
    this.isReserved = isReserved;
  }
}
Book.<b>properties</b> = {
  &quot;isbn&quot;: {range:&quot;String&quot;, label:&quot;ISBN&quot;, ...},
  &quot;title&quot;: {range:&quot;NonEmptyString&quot;, label:&quot;Title&quot;, ...},
  &quot;year&quot;: {range:&quot;Integer&quot;, label:&quot;Year&quot;, ...},
  &quot;edition&quot;: {range:&quot;PositiveInteger&quot;, label:&quot;Edition&quot;, ...},
  &quot;purchaseDate&quot;: {range:&quot;Date&quot;, label:&quot;Purchase date&quot;, ...},
  &quot;recordCreatedOn&quot;: {range:&quot;DateTime&quot;, label:&quot;Record created on&quot;, ...},
  &quot;isReserved&quot;: {range: &quot;Boolean&quot;, label:&quot;Is reserved&quot;}
}
Book.<b>displayAttribute</b> = &quot;title&quot;;
// collect business object classes in a map
dt.classes[&quot;Book&quot;] = Book;

export default Book;</pre></td></tr></tbody></table><p>For any other business object class, the same code sections are needed. In particular, you need to define your business object classes by extending the pre-defined OEMjs class <code>bUSINESSoBJECT</code>, which defines an ID attribute, implying that in the constructor of the subclass you need to invoke <code>super</code> with the ID constructor parameter of the subclass. In the example code above, since the ID attribute of the Book class is &quot;isbn&quot;, we have the invocation <code>super(isbn)</code>.</p><p>Notice that the properties of a class are not only defined in the constructor function (where they are assigned), but also in the property definitions map <code>Book.properties</code> which includes a definition record for each property, defining a <em>range</em> and a <em>label</em> for them. The property definitions are not fully shown above, indicated by &quot;...&quot;, which stands for the missing property constraint definitions. A complete discussion of property constraints is provided in the next section.</p><p>Suitable range constraints can be defined by using one of the supported range keywords listed below.</p><ul><li>&quot;String&quot;, &quot;NonEmptyString&quot;, &quot;Identifier&quot;, &quot;Email&quot;, &quot;URL&quot;, &quot;PhoneNumber&quot;</li><li>&quot;Integer&quot;, &quot;PositiveInteger&quot;, &quot;NonNegativeInteger&quot;, &quot;AutoNumber&quot;</li><li>&quot;Decimal&quot;, &quot;Number&quot;, &quot;Percent&quot;, &quot;ClosedUnitInterval&quot;, &quot;OpenUnitInterval&quot;</li><li>&quot;Boolean&quot;</li><li>&quot;Date&quot;, &quot;DateTime&quot;</li></ul><p>In addition to the ordinary alphanumeric attributes &quot;isbn&quot;, &quot;title&quot;, &quot;year&quot; and &quot;edition&quot;, which are rendered in the UI in the form of <i>input</i> fields, the <i>Book</i> class has three attributes with special ranges:</p><dl><dt>purchaseDate</dt><dd>This attribute has the range <i>Date</i>. A <i>Date</i> value is internally represented as a JS Date object, while it is &quot;stringified&quot; in the UI as an <em>ISO date string</em>, or rendered with the help of a <em>date picker</em>, which<em> </em>is a browser-built-in widget allowing the user to input a date by picking it from a calendar.</dd><dt>recordCreatedOn</dt><dd>This attribute has the range <i>DateTime</i>. A <i>DateTime</i> value is internally represented as a JS Date object, while it is &quot;stringified&quot; in the UI as an <em>ISO date time string</em>.</dd><dt>isReserved</dt><dd>This attribute has the range <i>Boolean</i>. A <i>Boolean</i> value is internally represented as either <i>true</i> or <i>false</i>, while it is &quot;stringified&quot; in the UI as &quot;yes&quot; or &quot;no&quot;, or rendered with the help of a <i>checkbox</i> field.</dd></dl><h3>The <kbd>app.mjs</kbd> module file</h3><p>For the simple &quot;Book Data Management&quot; app in the folder <kbd>apps/minimal/</kbd>, the <kbd>js/app.mjs</kbd> module has the following content:</p><table class="role-listing" style="width: 100%; border-collapse: collapse;"><colgroup class="listing-numbers-column" style="width: 2.25em;"></colgroup><tbody style="vertical-align: baseline;"><tr><td class="listing-numbers"><pre style="text-align: right; background-color: transparent; border-style: none; padding: 0; margin: 0;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td class="listing-lines"><pre style="text-align: left; background-color: transparent; border-style: none; padding: 0; margin: 0;">// import the app's business object classes
import Book from &quot;./Book.mjs&quot;;
// import the required framework classes
import sTORAGEmANAGER from &quot;../../../src/storage/sTORAGEmANAGER.mjs&quot;;
import bUSINESSaPP from &quot;../../../src/bUSINESSaPP.mjs&quot;;
// create the app object
const <b>app</b> = new bUSINESSaPP({title:&quot;Minimal OEMjs App&quot;,
    storageManager: new sTORAGEmANAGER({<b>adapterName</b>:&quot;IndexedDB&quot;, 
        dbName:&quot;MinApp&quot;, createLog: true, validateBeforeSave: true})
});<br />// set up the app<b>
app</b>.<b>setup</b>();
// define test data<b>
</b>Book.<b>testData</b> = [
  {isbn:&quot;0553345842&quot;, title:&quot;The Mind's I&quot;, year: 1982, ...},
  {isbn:&quot;1463794762&quot;, title:&quot;The Critique of Pure Reason&quot;, ...},
  {isbn:&quot;1928565379&quot;, title:&quot;The Critique of Practical Reason&quot;, ...},
  {isbn:&quot;0465030793&quot;, title:&quot;I Am A Strange Loop&quot;, ...}
];
// export the app object
export default app;</pre></td></tr></tbody></table><p>For any other app, the same code sections are needed in <kbd>app.mjs</kbd>. Notice that in the creation of the business app object in lines 7-9, a storage manager is specified with an <i>adapterName</i> parameter set to &quot;IndexedDB&quot;, which refers to the browser's built-in local storage technology. The <i>IndexedDB</i> storage option is always available and does not require any special setup. In addition to &quot;IndexedDB&quot;, OEMjs will also support remote storage technologies, especially cloud storage technologies such as Google's FireStore or Cloudflare's D1.</p><h3>The <kbd>index.html</kbd> file</h3><p>Any web application is started by loading a web page that loads its code and provides its user interface. It is common to use the name &quot;index.html&quot; for this app start page.</p><table class="role-listing" style="width: 100%; border-collapse: collapse;"><colgroup class="listing-numbers-column" style="width: 2.25em;"></colgroup><tbody style="vertical-align: baseline;"><tr><td class="listing-numbers"><pre style="text-align: right; background-color: transparent; border-style: none; padding: 0; margin: 0;">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="listing-lines"><pre style="text-align: left; background-color: transparent; border-style: none; padding: 0; margin: 0;">&lt;!DOCTYPE html&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;en&quot; lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;/&gt;
  ...
  &lt;script type=&quot;module&quot;&gt;
    import vIEW from &quot;../../src/ui/vIEW.mjs&quot;;
    import app from &quot;./js/app.mjs&quot;;
    window.addEventListener(&quot;load&quot;, vIEW.setupUI( app) );
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  ...
&lt;/body&gt;
&lt;/html&gt;</pre></td></tr></tbody></table><p>The HTML <code>head</code> element contains a <code>script</code> element, in which first the framework library <kbd>vIEW.mjs</kbd> and then the <kbd>app.mjs</kbd> module described above is loaded, followed by adding an event listener that calls the user interface setup procedure <code>vIEW.setupUI</code> after the HTML document has been loaded.</p></section><section class="role-section1" id="Intro-Constraint-Validation"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">1.2</span>. </span>Integrity Constraints and Data Validation</h2><p>For detecting non-admissible and inconsistent data and for preventing such data to be added to an application's database, we need to define suitable <strong><em>integrity constraints </em></strong> that can be used by the application's <strong><em>data validation</em></strong> mechanisms for catching these cases of flawed data. Integrity constraints are logical conditions that must be satisfied by the data entered by a user and stored in the application's database.</p><p>For instance, if an application is managing data about persons including their birth dates and their death dates, then we must make sure that for any person record with a death date, this date is not before that person's birth date.</p><p>Since <em>integrity maintenance</em> is fundamental in database management, the <em>data definition language</em> part of the <em>relational database language SQL</em> supports the definition of integrity constraints in various forms. On the other hand, however, there is hardly any support for integrity constraints and data validation in common programming languages such as Python, Java, C# or JavaScript. It is therefore important to take a systematic approach to constraint validation in web application engineering, like choosing an application development framework that provides sufficient support for it.</p><p>Unfortunately, many web application development frameworks do not provide sufficient support for defining integrity constraints and performing data validation. Integrity constraints should be defined in one (central) place in an app, and then be used for configuring the user interface and for validating data in different parts of the app, such as in the user interface code and in the data storage code. In terms of usability, the goals should be:</p><ol><li><p>To prevent the user from entering invalid data in the user interface (UI) by limiting the input options, if possible.</p></li><li><p>To detect and reject invalid user input as early as possible by performing constraint validation in the UI for those UI widgets where invalid user input cannot be prevented by limiting the input options.</p></li><li><p>To prevent that invalid data pollutes the app's main memory state and persistent database state by performing constraint validation also in the model layer and in the data storage layer.</p></li></ol><p>HTML5 provides support for validating user input in an HTML-forms-based user interface (UI). Here, the goal is to provide immediate feedback to the user whenever invalid data has been entered into a form field. This UI mechanism of <em><strong>responsive validation</strong></em> is an important feature of modern web applications. In traditional web applications, the back-end component validates the data and returns the validation results in the form of a set of error messages to the front-end. Only then, often several seconds later, and in the hard-to-digest form of a bulk message, does the user get the validation feedback.</p><p><dfn>Integrity constraints</dfn> (or simply <em>constraints</em>) are logical conditions on the data of an app. They may take many different forms. The most important type of constraints, <strong><em>property constraints</em></strong>, define conditions on the admissible property values of an object. They are defined for an object type (or class) such that they apply to all objects of that type. Some of the most important cases of property constraints are:</p><dl><dt><strong>Range Constraints</strong></dt><dd><p>require that an attribute must have a value from the value space of the type that has been defined as its range. For instance, in the following definition of the property &quot;title&quot;, its range is defined as &quot;NonEmptyString&quot;, which means that its values must be non-empty strings:</p><pre>Book.<b>properties</b> = {  
  &quot;title&quot;: {<b>range</b>:&quot;NonEmptyString&quot;, label:&quot;Title&quot;},
}</pre></dd><dt><strong>String Length Constraints</strong></dt><dd><p>require that the length of a string value for an attribute is less than a certain maximum number, or greater than a minimum number. String length constraints are defined with the fields <code>min</code> and <code>max</code> in a property definition:</p><pre>Book.<b>properties</b> = {  
  &quot;title&quot;: {range:&quot;NonEmptyString&quot;, label:&quot;Title&quot;, <b>min</b>: 2, <b>max</b>: 50},
}</pre></dd><dt><strong>Mandatory Value Constraints</strong></dt><dd><p>require that a property must have a value. For instance, a book must have a title, so the &quot;title&quot; attribute is defined to be mandatory In OEMjs, all properties are mandatory by default. A property is only non-mandatory, if it is defined to be optional, as in the following example:</p><pre>Book.<b>properties</b> = {  
  &quot;edition&quot;: {range:&quot;PositiveInteger&quot;, label:&quot;Edition&quot;, <b>optional</b>: true},
}</pre></dd><dt><strong>Interval Constraints</strong></dt><dd><p>require that the value of a numeric attribute must be in a specific interval, which defined with the fields <code>min</code> and <code>max</code>:</p><pre>Book.<b>properties</b> = {  
  &quot;year&quot;: {range:&quot;Integer&quot;, label:&quot;Year&quot;, <b>min</b>: 1459, <b>
           max</b>: () =&gt; (new Date()).getFullYear()+1},
}</pre><p>Notice that in this example, the value of the <code>max</code> field is a JS function that computes the next year.</p></dd><dt><strong>Pattern Constraints</strong></dt><dd><p>require that a string attribute's value must match a certain pattern defined by a regular expression. The pattern is defined with the field <code>pattern</code>, and the error message to be displayed in the case of a pattern violation is defined with the field <code>patternMessage</code>:</p><pre>Book.<b>properties</b> = {
  &quot;isbn&quot;: {range:&quot;String&quot;, label:&quot;ISBN&quot;, <b>pattern</b>:/\b\d{9}(\d|X)\b/,
    <b>patternMessage</b>:&quot;The ISBN must be a 9-digit string followed by 'X'!&quot;},
}</pre></dd><dt><strong>Cardinality Constraints</strong></dt><dd><p>apply to multi-valued properties, only, and require that the cardinality of a multi-valued property's value set is not less than a given minimum cardinality or not greater than a given maximum cardinality.</p><pre>Person.<b>properties</b> = {  
  &quot;phoneNumbers&quot;: {range:&quot;NonEmptyString&quot;, label:&quot;Phone numbers&quot;, 
                   <b>minCard</b>: 1, <b>maxCard</b>: Infinity},
}</pre><p>Using the special value <code>Infinity</code> as the value of the <code>maxCard</code> field means that the size of the property's value set is unbounded.</p></dd><dt><strong>Standard ID Constraints (also called 'Primary Key Constraints')</strong></dt><dd><p>require that a property's value is mandatory and unique among all instances of the given object type. They are defined with the help of the field <code>isIdAttribute</code>:</p><pre>Book.<b>properties</b> = {
  &quot;isbn&quot;: {range:&quot;String&quot;, <b>isIdAttribute</b>: true, label:&quot;ISBN&quot;},
}</pre></dd></dl></section><section class="role-section1" id="Generated-UI"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">1.3</span>. </span>Model-Based User Interface Generation</h2><p>Based on the property definitions of the <kbd>Book.mjs</kbd> module file, a default user interface (UI) is generated for each of the data management operations <em>Create</em>, <em>Retrieve</em>, <em>Update</em> and <em>Delete</em> (CRUD).</p><p>For the data management operation <em>Retrieve</em>, the following UI is created, showing all book records retrieved from the app's database:</p><figure id="Generated-UI__fig1-2"><img alt="A design model defining the object type Book with two invariants" class="responsive" height="313" src="index_files/Screenshot_Retrieve-all.png" width="772" /></figure><p>Notice that since the property <em>Edition</em> is optional, some book records have no value in the corresponding column. The values of the property <em>Purchase date</em> are shown using a localized format (here, the German date format). The values of the property <em>Record created on</em> are time stamps (or <em>date-time</em> values). The values of the Boolean property <em>Is reserved</em> are shown in the yes/no format.</p><p>For the data management operation <em>Update</em>, the following UI is created:</p><figure id="Generated-UI____1_fig1-2"><img alt="A design model defining the object type Book with two invariants" class="responsive" height="500" src="index_files/Screenshot_Update.png" width="590" /></figure></section></section><section class="role-appendix" id="appendix-1"><h1 class="role-appendix-title"><span class="role-label">Appendix <span class="role-number">A</span>. </span>Constraint Validation Concepts</h1><section class="role-section1" id="Concepts-IntegrityConstraints"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">A.1</span>. </span>Integrity Constraints</h2><p><dfn>Integrity constraints</dfn> (or simply <em>constraints</em>) are logical conditions on the data of an app. They may take many different forms. The most important type of constraints, <strong><em>property constraints</em></strong>, define conditions on the admissible property values of an object. They are defined for an object type (or class) such that they apply to all objects of that type. We concentrate on the most important cases of property constraints:</p><dl><dt><strong>String Length Constraints</strong></dt><dd><p>require that the length of a string value for an attribute is less than a certain maximum number, or greater than a minimum number.</p></dd><dt><strong>Mandatory Value Constraints</strong></dt><dd><p>require that a property must have a value. For instance, a person must have a name, so the name attribute must not be empty.</p></dd><dt><strong>Range Constraints</strong></dt><dd><p>require that an attribute must have a value from the value space of the type that has been defined as its range. For instance, an integer attribute must not have the value &quot;aaa&quot;.</p></dd><dt><strong>Interval Constraints</strong></dt><dd><p>require that the value of a numeric attribute must be in a specific interval.</p></dd><dt><strong>Pattern Constraints</strong></dt><dd><p>require that a string attribute's value must match a certain pattern defined by a regular expression.</p></dd><dt><strong>Cardinality Constraints</strong></dt><dd><p>apply to multi-valued properties, only, and require that the cardinality of a multi-valued property's value set is not less than a given minimum cardinality or not greater than a given maximum cardinality.</p></dd><dt><strong>Uniqueness Constraints (also called 'Key Constraints')</strong></dt><dd><p>require that a property's value is unique among all instances of the given object type.</p></dd><dt><strong>Referential Integrity Constraints</strong></dt><dd><p>require that the values of a reference property refer to an existing object in the range of the reference property.</p></dd><dt><strong>Frozen Value Constraints</strong></dt><dd><p>require that the value of a property must not be changed after it has been assigned initially.</p></dd></dl><p>The visual language of UML class diagrams supports defining integrity constraints either in a special way for special cases (like with predefined keywords), or, in the general case, with the help of <em>invariants</em>, which are conditions expressed either in plain English or in the <em><a href="#Concepts-IntegrityConstraints__aside-ocl" title="Object Constraint Language   (OCL)">Object Constraint Language (OCL)</a></em> and shown in a special type of rectangle attached to the model element concerned. We use UML class diagrams for modeling constraints in <em>design models</em> that are independent of a specific programming language or technology platform.</p><aside id="Concepts-IntegrityConstraints__aside-ocl"><h3>OCL</h3><p>The <em>Object Constraint Language</em> (OCL) was defined in 1997 as a formal logic language for expressing integrity constraints in UML version 1.1. Later, it was extended for allowing to define also (1) derivation expressions for defining derived properties, and (2) preconditions and postconditions for operations, in a class model.</p></aside><p>UML class diagrams provide special support for expressing multiplicity (or cardinality) constraints. This type of constraint allows to specify a lower multiplicity (minimum cardinality) or an upper multiplicity (maximum cardinality), or both, for a property or an association end. In UML, this takes the form of a multiplicity expression <code>l..u</code> where the lower multiplicity <code>l</code> is a non-negative integer and the upper multiplicity <code>u</code> is either a positive integer not smaller than <code>l</code> or the special value <code>*</code> standing for <em>unbounded</em>. For showing property multiplicity (or cardinality) constrains in a class diagram, multiplicity expressions are enclosed in brackets and appended to the property name, as shown in the <code>Person</code> class rectangle below.</p><p>In the following sections, we discuss the different types of property constraints listed above in more detail. We also show how to express some of them in computational languages such as <em>UML</em> class diagrams, <em>SQL</em> table creation statements, <em>JavaScript</em> model class definitions, or the annotation-based languages <em>Java Bean Validation</em> annotations and <em>ASP.NET Data Annotations</em>.</p><p>Any systematic approach to constraint validation also requires to define a set of error (or 'exception') classes, including one for each of the standard property constraints listed above.</p><section><h3>String Length Constraints</h3><p>The length of a string value for a property such as the title of a book may have to be constrained, typically rather by a maximum length, but possibly also by a minimum length. In an SQL table definition, a maximum string length can be specified in parenthesis appended to the SQL datatype <code>CHAR</code> or <code>VARCHAR</code>, as in <code>VARCHAR(50)</code>.</p><p>UML does not define any special way of expressing string length constraints in class diagrams. Of course, we always have the option to use an <em>invariant</em> for expressing any kind of constraint, but it seems preferable to use a simpler form of expressing these property constraints. One option is to append a maximum length, or both a minimum and a maximum length, in parenthesis to the datatype name, like so </p><figure> <img alt="Class Book with String Length Constraints" src="index_files/Book_withStringLengthConstraint_1.svg" width="180" /></figure><p>Another option is to use min/max constraint keywords in the property modifier list:</p><figure> <img alt="Class Book with String Length Constraints" src="index_files/Book_withStringLengthConstraint_2.svg" width="240" /> </figure></section><section><h3>Mandatory Value Constraints</h3><p>A <em>mandatory value constraint</em> requires that a property must have a value. This can be expressed in a UML class diagram with the help of a multiplicity constraint expression where the lower multiplicity is 1. For a single-valued property, this would result in the multiplicity expression <code>1..1</code>, or the simplified expression <code>1</code>, appended to the property name in brackets. For example, the following class diagram defines a mandatory value constraint for the property <code>name</code>: </p><figure> <img alt="Class diagram with Mandatory Value Constraints" src="index_files/Person_ExampleModel.svg" width="180" /></figure><p>Whenever a class rectangle does not show a multiplicity expression for a property, the property is mandatory (and single-valued), that is, the multiplicity expression <code>1</code> is the default for properties.</p><p>In an SQL table creation statement, a mandatory value constraint is expressed in a table column definition by appending the key phrase <code>NOT NULL</code> to the column definition as in the following example:</p><pre class="role-listing"><span class="hl-keyword">CREATE</span> <span class="hl-keyword">TABLE</span> persons(
  <span class="hl-keyword">name</span>  <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">30</span>) <strong>NOT NULL</strong>,
  age   <span class="hl-keyword">INTEGER</span>
)</pre><p>According to this table definition, any row of the <code>persons</code> table must have a value in the column <code>name</code>, but not necessarily in the column <code>age</code>.</p><p>In JavaScript, we can code a mandatory value constraint by a class-level check function that tests if the provided argument evaluates to a value, as illustrated in the following example:</p><pre class="role-listing">Person.checkName = <span class="hl-keyword">function</span> (n) {
  <span class="hl-keyword">if</span> (<strong>n ===</strong> <span class="hl-keyword">undefined</span>) {
    <span class="hl-keyword">return</span> <span class="hl-string">&quot;A name must be provided!&quot;</span>; <span class="hl-comment">// constraint violation error message</span>
  } <span class="hl-keyword">else</span> <span class="hl-keyword">return</span> <span class="hl-string">&quot;&quot;</span>;  <span class="hl-comment">// no constraint violation</span>
};</pre><p>With Java Bean Validation, a mandatory property like <code>name</code> is annotated with <code>NotNull</code> in the following way:</p><pre class="role-listing"><span class="hl-annotation">@Entity</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Person {
  <strong>@NotNull</strong>
  <span class="hl-keyword">private</span> String name;
  <span class="hl-keyword">private</span> <span class="hl-keyword">int</span> age;
}</pre><p>The equivalent ASP.NET Data Annotation is <code>Required</code> as shown in</p><pre class="role-listing"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Person {
  [<strong>Required</strong>]
  <span class="hl-keyword">public</span> string name { get; set; }
  <span class="hl-keyword">public</span> int age { get; set; }
}</pre></section><section><h3>Range Constraints</h3><p>A range constraint requires that a property must have a value from the value space of the type that has been defined as its range. This is implicitly expressed by defining a type for a property as its range. For instance, the attribute <code>age</code> defined for the object type <code>Person</code> in the class diagram above has the range <code>Integer</code>, so it must not have a value like &quot;aaa&quot;, which does not denote an integer. However, it may have values like -13 or 321, which also do not make sense as the age of a person. In a similar way, since its range is <code>String</code>, the attribute <code>name</code> may have the value &quot;&quot; (the empty string), which is a valid string that does not make sense as a name.</p><p>We can avoid allowing negative integers like -13 as age values, and the empty string as a name, by assigning more specific datatypes as range to these attributes, such as <code>NonNegativeInteger</code> to <code>age</code>, and <code>NonEmptyString</code> to <code>name</code>. Notice that such more specific datatypes are neither predefined in SQL nor in common programming languages, so we have to implement them either in the form of user-defined types, as supported in SQL-99 database management systems such as PostgreSQL, or by using suitable additional constraints such as <em>interval constraints</em>, which are discussed in the next section. In a UML class diagram, we can simply define <code>NonNegativeInteger</code> and <code>NonEmptyString</code> as custom datatypes and then use them in the definition of a property, as illustrated in the following diagram: </p><figure> <img alt="Class Diagram with Range Constraints" src="index_files/Person_ExampleModelWithCustomPropertyRange.svg" width="250" /> </figure><p>In JavaScript, we can code a range constraint by a check function, as illustrated in the following example:</p><pre class="role-listing">Person.checkName = <span class="hl-keyword">function</span> (n) {
  <span class="hl-keyword">if</span> (<span class="hl-keyword">typeof</span>(n) !== <span class="hl-string">&quot;string&quot;</span> || n.trim() === <span class="hl-string">&quot;&quot;</span>) {
    <span class="hl-keyword">return</span> <span class="hl-string">&quot;Name must be a non-empty string!&quot;</span>;
  } <span class="hl-keyword">else</span> <span class="hl-keyword">return</span> <span class="hl-string">&quot;&quot;</span>;
};</pre><p>This check function detects and reports a constraint violation if the given value for the <code>name</code> property is not of type &quot;string&quot; or is an empty string.</p><p>In a Java EE web app, for declaring empty strings as non-admissible user input we must set the context parameter <code>javax.faces.INTERPRET_EMPTY_STRING_SUBMITTED_VALUES_AS_NULL </code> to <code>true</code> in the web deployment descriptor file <code>web.xml</code>.</p><p>In ASP.NET, empty strings are non-admissible by default.</p></section><section><h3>Interval Constraints</h3><p>An interval constraint requires that an attribute's value must be in a specific interval, which is specified by a minimum value or a maximum value, or both. Such a constraint can be defined for any attribute having an ordered type, but normally we define them only for numeric datatypes or calendar datatypes. For instance, we may want to define an interval constraint requiring that the <code>age</code> attribute value must be in the interval [25,70]. In a class diagram, we can define such a constraint by using the property modifiers <code>min</code> and <code>max</code>, as shown for the <code>age</code> attribute of the <code>Driver</code> class in the following diagram.</p><figure> <img alt="Class Diagram with Interval Constraints" src="index_files/Driver_ExampleModelWithIntervalConstraint.svg" width="250" /></figure><p>In an SQL table creation statement, an interval constraint is expressed in a table column definition by appending a suitable <code>CHECK</code> clause to the column definition as in the following example: </p><pre class="role-listing"><span class="hl-keyword">CREATE</span> <span class="hl-keyword">TABLE</span> drivers(
  <span class="hl-keyword">name</span>  <span class="hl-keyword">VARCHAR</span> <span class="hl-keyword">NOT</span> <span class="hl-keyword">NULL</span>,
  age   <span class="hl-keyword">INTEGER</span> <strong>CHECK</strong> (age &gt;= <span class="hl-number">25</span> <span class="hl-keyword">AND</span> age &lt;= <span class="hl-number">70</span>)
)</pre><p>In JavaScript, we can code an interval constraint in the following way:</p><pre class="role-listing">Driver.checkAge = <span class="hl-keyword">function</span> (a) {
  <span class="hl-keyword">if</span> (<strong>a &lt;</strong> <span class="hl-number">25</span> || <strong>a &gt;</strong> <span class="hl-number">70</span>) {
    <span class="hl-keyword">return</span> <span class="hl-string">&quot;Age must be between 25 and 70!&quot;</span>;
  } <span class="hl-keyword">else</span> <span class="hl-keyword">return</span> <span class="hl-string">&quot;&quot;</span>;
};</pre><p>In Java Bean Validation, we express this interval constraint by adding the annotations <code>Min()</code> and <code>Max()</code> to the property <code>age</code> in the following way:</p><pre class="role-listing"><span class="hl-annotation">@Entity</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Driver {
  <span class="hl-annotation">@NotNull</span>
  <span class="hl-keyword">private</span> String name;
  <strong>@Min</strong>(<span class="hl-number">25</span>) <strong>@Max</strong>(<span class="hl-number">70</span>)
  <span class="hl-keyword">private</span> <span class="hl-keyword">int</span> age;
}</pre><p>The equivalent ASP.NET Data Annotation is <code>Range(25,70)</code> as shown in</p><pre class="role-listing"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Driver{
  [Required]
  <span class="hl-keyword">public</span> string name { get; set; }
  [<strong>Range</strong>(<span class="hl-number">25</span>,<span class="hl-number">70</span>)]
  <span class="hl-keyword">public</span> int age { get; set; }
}</pre></section><section><h3>Pattern Constraints</h3><p>A pattern constraint requires that a string attribute's value must match a certain pattern, typically defined by a <em>regular expression</em>. For instance, for the object type <code>Book</code> we define an <code>isbn</code> attribute with the datatype <code>String</code> as its range and add a pattern constraint requiring that the <code>isbn</code> attribute value must be a 10-digit string or a 9-digit string followed by &quot;X&quot; to the <code>Book</code> class rectangle shown in the following diagram.</p><figure> <img alt="Class Book with Pattern Constraints" src="index_files/Book_ExampleModelWithPatternConstraint.svg" width="340" /> </figure><p>In an SQL table creation statement, a pattern constraint is expressed in a table column definition by appending a suitable <code>CHECK</code> clause to the column definition as in the following example: </p><pre class="role-listing"><span class="hl-keyword">CREATE</span> <span class="hl-keyword">TABLE</span> books(
  isbn   <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">10</span>) <span class="hl-keyword">NOT</span> <span class="hl-keyword">NULL</span> <strong>CHECK</strong> (isbn ~ <span class="hl-string">'^\d{9}(\d|X)$'</span>),
  title  <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">50</span>) <span class="hl-keyword">NOT</span> <span class="hl-keyword">NULL</span>
)</pre><p>The <code>~</code> (tilde) symbol denotes the regular expression matching predicate and the regular expression <code>^\d{9}(\d|X)$</code> follows the syntax of the POSIX standard (see, e.g. the <a href="http://www.postgresql.org/docs/9.0/static/functions-matching.html" target="_top" title="PostgreSQL documentation">PostgreSQL documentation</a>).</p><p>In JavaScript, we can code a pattern constraint by using the built-in regular expression function <code>test</code>, as illustrated in the following example:</p><pre class="role-listing">Person.checkIsbn = <span class="hl-keyword">function</span> (id) {
  <span class="hl-keyword">if</span> (!/\b\d{<span class="hl-number">9</span>}(\d|X)\b/.<strong>test</strong>( id)) {
    <span class="hl-keyword">return</span> <span class="hl-string">&quot;The ISBN must be a 10-digit string or a 9-digit string followed by 'X'!&quot;</span>;
  } <span class="hl-keyword">else</span> <span class="hl-keyword">return</span> <span class="hl-string">&quot;&quot;</span>;
};</pre><p>In Java EE Bean Validation, this pattern constraint for <code>isbn</code> is expressed with the annotation <code>Pattern</code> in the following way:</p><pre class="role-listing"><span class="hl-annotation">@Entity</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Book {
<span class="hl-annotation">@NotNull</span>
  <strong>@Pattern</strong>(regexp=<span class="hl-string">&quot;^\\(\d{9}(\d|X))$&quot;</span>)
  <span class="hl-keyword">private</span> String isbn;
  <span class="hl-annotation">@NotNull</span>
  <span class="hl-keyword">private</span> String title;
}</pre><p>The equivalent ASP.NET Data Annotation is <code>RegularExpression</code> as shown in</p><pre class="role-listing"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Book{
  [Required]
  [<strong>RegularExpression</strong>(@<span class="hl-string">&quot;^(\d{9}(\d|X))$&quot;</span>)]
  <span class="hl-keyword">public</span> string isbn { get; set; }
  <span class="hl-keyword">public</span> string title { get; set; }
}</pre></section><section><h3>Cardinality Constraints</h3><p>A cardinality constraint requires that the cardinality of a multi-valued property's value set is not less than a given <strong><em>minimum cardinality</em></strong> or not greater than a given <strong><em>maximum cardinality</em></strong>. In UML, cardinality constraints are called <strong><em>multiplicity constraints</em></strong>, and minimum and maximum cardinalities are expressed with the lower bound and the upper bound of the multiplicity expression, as shown in the following diagram, which contains two examples of properties with cardinality constraints.</p><figure> <img alt="Class Book with Cardinality Constraints" src="index_files/CardinalityConstraintsExamples.svg" width="340" /> </figure><p>The attribute definition <code>nickNames[0..3]</code> in the class <code>Person</code> specifies a minimum cardinality of 0 and a maximum cardinality of 3, with the meaning that a person may have no nickname or at most 3 nicknames. The reference property definition <code>members[3..5]</code> in the class <code>Team</code> specifies a minimum cardinality of 3 and a maximum cardinality of 5, with the meaning that a team must have at least 3 and at most 5 members.</p><p>It's not obvious how cardinality constraints could be checked in an SQL database, as there is no explicit concept of cardinality constraints in SQL, and the generic form of constraint expressions in SQL, assertions, are not supported by available DBMSs. However, it seems that the best way to implement a minimum (or maximum) cardinality constraint is an on-delete (or on-insert) trigger that tests the number of rows with the same reference as the deleted (or inserted) row.</p><p>In JavaScript, we can code a cardinality constraint validation for a multi-valued property by testing the size of the property's value set, as illustrated in the following example:</p><pre class="role-listing">Person.checkNickNames = <span class="hl-keyword">function</span> (nickNames) {
  <span class="hl-keyword">if</span> (<strong>nickNames.length</strong> &gt; <span class="hl-number">3</span>) {
    <span class="hl-keyword">return</span> <span class="hl-string">&quot;There must be no more than 3 nicknames!&quot;</span>;
  } <span class="hl-keyword">else</span> <span class="hl-keyword">return</span> <span class="hl-string">&quot;&quot;</span>;
};</pre><p>With Java Bean Validation annotations, we can specify</p><pre class="role-listing">
<strong>@Size</strong>( max=<span class="hl-number">3</span>)
List&lt;String&gt; <strong>nickNames</strong>
<strong>@Size</strong>( min=<span class="hl-number">3</span>, max=<span class="hl-number">5</span>)
List&lt;Person&gt; <strong>members</strong></pre></section><section><h3>Uniqueness Constraints</h3><p>A <em>uniqueness constraint</em> (or <em>key constraint</em>) requires that a property's value (or the value list of a list of properties in the case of a composite key constraint) is unique among all instances of the given object type. For instance, in a UML class diagram with the object type <code>Book</code> we can define the <code>isbn</code> attribute to be <em><em>unique</em></em>, or, in other words, a <em><em>key</em></em>, by appending the (user-defined) property modifier keyword <code>key</code> in curly braces to the attribute's definition in the <code>Book</code> class rectangle shown in the following diagram.</p><figure> <img alt="Class Book with Uniqueness Constraints" src="index_files/Book_ExampleModelWithUniquenessConstraint.svg" width="180" /> </figure><p>In an SQL table creation statement, a uniqueness constraint is expressed by appending the keyword <code>UNIQUE</code> to the column definition as in the following example:</p><pre class="role-listing"><span class="hl-keyword">CREATE</span> <span class="hl-keyword">TABLE</span> books(
  isbn   <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">10</span>) <span class="hl-keyword">NOT</span> <span class="hl-keyword">NULL</span> <strong>UNIQUE</strong>,
  title  <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">50</span>) <span class="hl-keyword">NOT</span> <span class="hl-keyword">NULL</span>
)</pre><p>In JavaScript, we can code this uniqueness constraint by a check function that tests if there is already a book with the given <code>isbn</code> value in the <code>books</code> table of the app's database.</p></section><section><h3>Standard Identifiers (Primary Keys)</h3><p>A unique attribute (or a composite key) can be declared to be the standard identifier for objects of a given type, if it is mandatory (or if all attributes of the composite key are mandatory). We can indicate this in a UML class diagram with the help of the property modifier <code>id</code> appended to the declaration of the attribute <code>isbn</code> as shown in the following diagram.</p><figure> <img alt="Class Book with Standard Identifiers (Primary Keys)" src="index_files/Book_ExampleModelWithStandardIdentifier.svg" width="180" /></figure><p>Notice that such a standard ID declaration implies both a mandatory value and a uniqueness constraint on the attribute concerned.</p><p>Often, practitioners do not recommended using a composite key as a standard ID, since composite identifiers are more difficult to handle and not always supported by tools. Whenever an object type does not have a key attribute, but only a composite key, it may therefore be preferable to add an artificial standard ID attribute (also called <em>surrogate ID</em>) to the object type. However, each additional surrogate ID has a price: it creates some cognitive and computational overhead. Consequently, in the case of a simple composite key, it may be preferable not to add a surrogate ID, but use the composite key as the standard ID.</p><p>There is also an argument against using any real attribute, such as the <code>isbn</code> attribute, for a standard ID. The argument points to the risk that the values even of natural ID attributes like <code>isbn</code> may have to be changed during the life time of a business object, and any such change would require an unmanageable effort to change also all corresponding ID references. However, the business semantics of natural ID attributes implies that they are frozen. Thus, the need of a value change can only occur in the case of a data input error. But such a case is normally detected early in the life time of the object concerned, and at this stage the change of all corresponding ID references is still manageable.</p><p>Standard IDs are called <em>primary keys</em> in relational databases. We can declare an attribute to be the primary key in an SQL table creation statement by appending the phrase <code>PRIMARY KEY</code> to the column definition as in the following example: </p><pre class="role-listing"><span class="hl-keyword">CREATE</span> <span class="hl-keyword">TABLE</span> books(
  isbn   <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">10</span>) <strong>PRIMARY KEY</strong>,
  title  <span class="hl-keyword">VARCHAR</span>(<span class="hl-number">50</span>) <span class="hl-keyword">NOT</span> <span class="hl-keyword">NULL</span>
)</pre><p>In object-oriented programming languages, like JavaScript and Java, we cannot code a standard ID declaration, because this would have to be part of the metadata of a class definition, and there is no support for such metadata. However, we should still check the implied mandatory value and uniqueness constraints.</p></section><section><h3>Referential Integrity Constraints</h3><p>A referential integrity constraint requires that the values of a reference property refer to an object that exists in the population of the property's range class. Since we do not deal with reference properties in this chapter, we postpone the discussion of referential integrity constraints to <a href="https://webengineering.netlify.app/js-firebase/unidir-associations-app/">Part 4</a> of our tutorial.</p></section><section><h3>Frozen and Read-Only Value Constraints</h3><p>A frozen value constraint defined for a property requires that the value of this property must not be changed after it has been assigned. This includes the special case of <strong><em>read-only value constraints</em></strong> on mandatory properties that are initialized at object creation time.</p><p>Typical examples of properties with a frozen value constraint are standard identifier attributes and event properties. In the case of events, the semantic principle that the past cannot be changed prohibits that the property values of events can be changed. In the case of a standard identifier attribute we may want to prevent users from changing the ID of an object since this requires that all references to this object using the old ID value are changed as well, which may be difficult to achieve (even though SQL provides special support for such ID changes by means of its <code>ON UPDATE CASCADE</code> clause for the change management of foreign keys).</p><p>The following diagram shows how to define a frozen value constraint for the <code>isbn</code> attribute:</p><figure> <img alt="Class Book with Frozen and Read-Only Value Constraints" src="index_files/Book_ExampleModelWithFrozenValConstr.svg" width="200" /></figure><p>In Java, a <em>read-only</em> value constraint can be enforced by declaring the property to be <code>final</code>. In JavaScript, a <em>read-only</em> property slot can be implemented as in the following example:</p><pre class="role-listing"><span class="hl-keyword">Object</span>.defineProperty( obj, <span class="hl-string">&quot;teamSize&quot;</span>, {value: <span class="hl-number">5</span>, <strong>writable: false</strong>, enumerable: true})</pre><p>where the property slot <code>obj.teamSize</code> is made unwritable. An entire object <code>obj</code> can be frozen with <code>Object.freeze( obj)</code>.</p><p>We can implement a frozen value constraint for a property in the property's setter method like so:</p><pre class="role-listing">Book.<span class="hl-keyword">prototype</span>.setIsbn = <span class="hl-keyword">function</span> (i) {
  <span class="hl-keyword">if</span> (<span class="hl-keyword">this</span>.isbn === <span class="hl-keyword">undefined</span>) <span class="hl-keyword">this</span>.isbn = i;
  <span class="hl-keyword">else</span> console.log(<span class="hl-string">&quot;Attempt to re-assign a frozen property!&quot;</span>);
}</pre></section><section><h3>Beyond property constraints</h3><p>So far, we have only discussed how to define and check <em>property constraints</em>. However, in certain cases there may be also integrity constraints that do not just depend on the value of a particular property, but rather on </p><ol><li><p>the values of several properties of a particular object (object-level constraints),</p></li><li><p>the value of a property before and its value after a change attempt (dynamic constraints),</p></li><li><p>the set of all instances of a particular object type (type-level constraints),</p></li><li><p>the set of all instances of several object types.</p></li></ol><p>In a class model, property constraints can be expressed within the property declaration line in a class rectangle (typically with keywords, such as <code>id</code>, <code>max</code>, etc.). For expressing more complex constraints, such as object-level or type-level constraints, we can attach an <em>invariant</em> declaration box to the class rectangle(s) concerned and express the constraint either in (unambiguous) English or in the <em><a href="#Concepts-IntegrityConstraints__aside-ocl" title="Object Constraint Language (OCL)">Object Constraint Language (OCL)</a></em>. A simple example of an object-level constraint expressed as an OCL invariant is shown in <a class="role-figure-ref" href="#Concepts-IntegrityConstraints__fig1-1"><span class="role-label">Figure <span class="role-number">A-1</span>. </span>An example of an object-level constraint</a>.</p><figure id="Concepts-IntegrityConstraints__fig1-1"><figcaption><span class="role-label">Figure <span class="role-number">A-1</span>. </span>An example of an object-level constraint</figcaption> <img alt="Example of an Object-Level Constraint" src="index_files/AuthorConstraints.svg" width="200" /> </figure><p>A general approach for implementing <em>object-level constraint validation</em> consists of taking the following steps:</p><ol><li><p>Choose a fixed name for an object-level constraint validation function, such as <code>validate</code>.</p></li><li><p>For any class that needs object-level constraint validation, define a <code>validate</code> function returning either a <code>ConstraintViolation</code> or a <code>NoConstraintViolation</code> object.</p></li><li><p>Call this function, if it exists, for the given model class,</p><ol><li><p>in the UI/view, on form submission;</p></li><li><p>in the model class, before save, both in the <code>create</code> and in the <code>update</code> method.</p></li></ol></li></ol></section></section><section class="role-section1" id="Concepts-ResponsiveValidation"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">A.2</span>. </span>Responsive Validation</h2><p>This problem is well-known from classical web applications where the front-end component submits the user input data via HTML form submission to a back-end component running on a remote web server. Only this back-end component validates the data and returns the validation results in the form of a set of error messages to the front-end. Only then, often several seconds later, and in the hard-to-digest form of a bulk message, does the user get the validation feedback. This approach is no longer considered acceptable today. Rather, in a <em>responsive validation</em> approach, the user should get immediate validation feedback on each single data input. Technically, this can be achieved with the help of event handlers for the user interface events <code>input</code> or <code>change</code>.</p><p>Responsive validation requires a data validation mechanism in the user interface (UI), such as the <a href="http://www.html5rocks.com/en/tutorials/forms/constraintvalidation/" target="_top" title="HTML5 form validation API">HTML5 form validation API</a>, which essentially provides new types of <code>input</code> fields (such as <code>number</code> or <code>date</code>), a set of new attributes for form control elements and new JS methods for the purpose of supporting responsive validation performed by the browser. Since using the new validation attributes (like <code>required</code>, <code>min</code>, <code>max</code> and <code>pattern</code>) implies defining constraints in the UI, they are not really useful in a general approach where constraints are only checked, but not defined, in the UI.</p><p>Consequently, we only use two methods of the HTML5 form validation API for validating constraints in the HTML-forms-based user interface of our app. The first of them, <code>setCustomValidity</code>, allows to mark a form field as either valid or invalid by assigning either an empty string or a non-empty (constraint violation) message string.</p><p>The second method, <code>checkValidity</code>, is invoked on a form before user input data is committed or saved (for instance with a form submission). It tests, if all fields have a valid value. For having the browser automatically displaying any constraint violation messages, we need to have a <code>submit</code> event, even if we don't really submit the form, but just use a <code>save</code> button.</p><p>See also this <a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation" target="_top" title="Mozilla tutorial on Constraint Validation">Mozilla tutorial</a> for more about the HTML5 form validation API.</p></section><section class="role-section1" id="Concepts-MVC"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">A.3</span>. </span>Constraint Validation in MVC Applications</h2><p>Integrity constraints should be defined in the model classes of an MVC app since they are part of the business semantics of a model class (representing a business object type). However, a more difficult question is where to perform data validation? In the database? In the model classes? In the controller? Or in the user interface (&quot;view&quot;)? Or in all of them?</p><p>A relational database management system (DBMS) performs data validation whenever there is an attempt to change data in the database, provided that all relevant integrity constraints have been defined in the database. This is essential since we want to avoid, under all circumstances, that invalid data enters the database. However, it requires that we somehow duplicate the code of each integrity constraint, because we want to have it also in the model class to which the constraint belongs.</p><p>Also, if the DBMS would be the only application component that validates the data, this would create a latency, and hence usability, problem in distributed applications because the user would not get immediate feedback on invalid input data. Consequently, data validation needs to start in the user interface (UI).</p><p>However, it is not sufficient to perform data validation in the UI. We also need to do it in the model classes, and in the database, for making sure that no flawed data enters the application's persistent data store. This creates the problem of how to maintain the constraint definitions in one place (the model), but use them in two or three other places (at least in the model classes and in the UI code, and possibly also in the database).We call this the <strong><em>multiple validation problem</em></strong>. This problem can be solved in different ways. For instance:</p><ol><li><p>Define the constraints in a declarative language (such as <em>Java Bean Validation Annotations</em> or <em>ASP.NET Data Annotations</em>) and generate the back-end/model and front-end/UI validation code both in a back-end application programming language such as Java or C#, and in JavaScript.</p></li><li><p>Keep your validation functions in the (PHP, Java, C# etc.) model classes on the back-end, and invoke them from the JavaScript UI code via XHR. This approach can only be used for specific validations, since it implies the penalty of an additional HTTP communication latency for each validation invoked in this way.</p></li><li><p>Use JavaScript as your back-end application programming language (such as with NodeJS), then you can code your validation functions in your JavaScript model classes on the back-end and execute them both before committing changes on the back-end and on user input and form submission in the UI on the front-end side.</p></li></ol><p>The simplest, and most responsive, solution is the third one, using only JavaScript both for the back-end and front-end components of a web app.</p></section><section class="role-section1" id="Concepts-DesignModelConstraints"><h2 class="role-section1-title"><span class="role-label"><span class="role-number">A.4</span>. </span>Adding Constraints to a Class Design Model</h2><section><p>The <strong><em>data integrity rules</em></strong> (or 'business rules') that govern the management of data can be expressed in the form of <em>invariants</em> in a UML class model as shown in the following diagram.</p><figure id="Concepts-DesignModelConstraints__fig1-2"> <img alt="A design model defining the object type Book with two invariants" class="responsive" src="index_files/Book_SimpleAppDesM.svg" /></figure><p>In this model, the following constraints have been expressed:</p><ol><li><p>Due to the fact that the <code>isbn</code> attribute is declared to be the <em>standard identifier</em> of <code>Book</code>, it is <strong><em>mandatory</em></strong> and <strong><em>unique</em></strong>.</p></li><li><p>The <code>isbn</code> attribute has a <strong><em>pattern constraint</em></strong> requiring its values to match the ISBN-10 format that admits only 10-digit strings or 9-digit strings followed by &quot;X&quot;.</p></li><li><p>The <code>title</code> attribute is <strong><em>mandatory</em></strong>, as indicated by its multiplicity expression [1], and has a <strong><em>string length constraint</em></strong> requiring its values to have at most 50 characters.</p></li><li><p>The <code>year</code> attribute is <strong><em>mandatory</em></strong> and has an <strong><em>interval constraint</em></strong>, however, of a special form since the maximum is not fixed, but provided by the calendar function <code>nextYear()</code>, which we implement as a utility function.</p></li></ol><p>Notice that the <code>edition</code> attribute is not mandatory, but <em>optional</em>, as indicated by its multiplicity expression [0..1]. In addition to the constraints described in this list, there are the implicit range constraints defined by assigning the datatype <code>NonEmptyString</code> as range to <code>isbn</code> and <code>title</code>, <code>Integer</code> to <code>year</code>, and <code>PositiveInteger</code> to <code>edition</code>. In our plain JavaScript approach, all these property constraints are coded in the model class within property-specific <em>check</em> functions.</p><p>The meaning of the design model can be illustrated by a sample data population respecting all constraints:</p><table border="1" id="Concepts-DesignModelConstraints__lot__1"><caption><span class="role-label">Table <span class="role-number">A-1</span>. </span>Sample data for <code>Book</code></caption><thead><tr><th>ISBN</th><th>Title</th><th>Year</th><th>Edition</th></tr></thead><tbody><tr><td>006251587X</td><td>Weaving the Web</td><td>2000</td><td>3</td></tr><tr><td>0465026567</td><td>GÃ¶del, Escher, Bach</td><td>1999</td><td>2</td></tr><tr><td>0465030793</td><td>I Am A Strange Loop</td><td>2008</td><td></td></tr></tbody></table> </section></section></section><div class="role-backmatter" id="backmatter"><section class="role-index" id="_index"><h1 class="role-index-title">Index</h1></section></div></section></body></html>